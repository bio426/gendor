import { Eta } from "eta"
import { toBlob } from "html-to-image"

const eta = new Eta()

type OrderPayload = {
    id: string
    name: string
    address: string
    dni: string
    ruc: string
    date: string
    brand: string
    model: string
    color: string
    plate: string
    mileage: string
    items: {
        code: string
        quantity: string
        description: string
        punit: string
        ptotal: string
    }[],
    observation: string
    subtotal: string
    total: string
}

export default {
    printableString(payload: OrderPayload): string {
        const rendered = eta.renderString(minifiedTemplate, payload)

        return rendered
    },
    async testClipboard(payload: OrderPayload): Promise<Blob> {
        const rendered = eta.renderString(clipboardTemplate, payload)
        const tmpDiv = document.createElement("div")
        tmpDiv.innerHTML = rendered
        const target = tmpDiv.querySelector("#a4") as HTMLDivElement
        document.body.appendChild(tmpDiv)
        const imgBlob = await toBlob(target)
        tmpDiv.remove()
        if (imgBlob == null) throw new Error("Unmakeable blob")
        return imgBlob
    },
}

const minifiedTemplate = `
<!doctypehtml><html lang=en><title>Gendor Invoice</title><meta charset=UTF-8><meta content="width=device-width"name=viewport><style>*{margin:0;padding:0;font-family:sans-serif;font-size:14px}@page{size:auto;margin:0}@media print{body,html{height:100%;margin:0!important;padding:0!important;overflow:hidden}}.invoice{display:flex;flex-direction:column;height:27.2cm;padding:1rem;background:#fff}.invoice__row1{display:grid;grid-template-columns:1fr 2fr 1fr;gap:1rem;margin-bottom:1rem}.invoice__logo{display:grid;place-content:center}.invoice__svg{width:100%}.invoice__id{display:flex;flex-direction:column;justify-content:center;gap:1rem;padding:.5rem;border:1px solid #000;text-align:center}.invoice__row2{display:grid;grid-template-columns:1fr 1fr;padding:.5rem;margin-bottom:1rem;border:1px solid #000}.invoice__ctnr1{display:flex;flex-direction:column;gap:.5rem}.invoice__row3{flex-grow:1;border:1px solid #000;margin-bottom:1rem}.invoice__table{width:100%;border-collapse:collapse}.invoice__table th{padding:.5rem;border:1px solid #000;border-top:none}.invoice__table td{padding:.2rem .5rem}.invoice__table th:first-child{border-left:none}.invoice__table th:last-child{border-right:none}.invoice__row4{display:grid;grid-template-columns:2fr 1fr;gap:1rem}.invoice__observation{padding:.5rem;border:1px solid #000}.invoice__total{display:flex;flex-direction:column;border:1px solid #000}.invoice__amount{display:flex;justify-content:space-between;margin-bottom:.5rem}.invoice__ctnr2{flex-grow:1;padding:.5rem}.invoice__ctnr3{padding:.5rem;border-top:1px solid #000}</style><div class=invoice><div class=invoice__row1><div class=invoice__logo><svg class=invoice__svg viewBox="0 0 139 58"xmlns=http://www.w3.org/2000/svg><path d="M18.5 1.5V9c-.333-.333-1.6-1-4-1-3 0-5.5 2.5-5.5 6s1.5 6 5.5 6.5c2.5.313 3-3.5-1-2.5v-5.5H21c3.5 3.5 3.5 14-6.5 15C10.333 27.833 1 25.5 1 14 1 .5 15.5 0 18.5 1.5ZM40.5 1.5v7H35c-.333.167-1 .7-1 1.5 0 1 .5 1.5 1 1.5h5.5V17H35c-.5 0-1.5.2-1.5 1 0 1 0 1.5 1.5 1.5h5.5V27h-7c-2.5-.167-7.5-1.7-7.5-6.5V7c.333-1.833 2-5.5 6-5.5h8.5ZM45 27V1.5h12c4.5 0 7.5 3.5 7.5 8 0 3.6-2.333 6.167-3.5 7L65.5 27H58l-4-8v-6.5h1c1.6 0 2-1 2-2.5 0-.8-1-1.5-2-1.5h-2.5V27H45ZM68 8.5V27h7.5v-6h2v-7h-2V9.5c0-1 1-1.5 2-1.5.8 0 1.5.5 1.5 1.5V27h7.5V8.5c0-2-2-8-9-8C71.9.5 68 5 68 8.5ZM103 1.5H91V27h7.5V8.5h3c.5 0 1.5.5 1.5 1.5 0 2-1.5 2.5-3 2.5V19l3.5 8h8c-1.667-3.333-4.9-10.1-4.5-10.5.5-.5 3.5-1.5 3.5-7s-4-8-7.5-8ZM114 27V1.5h12c2 0 12.5 1.5 12.5 12.5 0 9.6-8.5 13-12.5 13h-3v-7.5h3c3 0 5-2.5 5-5.5 0-3.2-2.5-5.5-5-5.5h-4.5V27H114ZM14.5 38v-7c0-.5-1.5-.5-3.5-.5-4.5 0-8 4.5-8 8s3 8 3 9c0 1.5-1.5 2-2.5 2-.8 0-1.667-.333-2-.5v7c0 .5 2 1 4 1 4.5 0 9-4.5 9-8.5 0-3.86-3-6.5-3-9 0-1.2 1-2 3-1.5ZM33 38v-7h-7.5c-4.8 0-7 3.896-7 6v13c0 4 4.5 6.5 7 6.5H33V49h-6c-1 0-1.5-.5-1.5-1.5 0-.8 1-1 1.5-1h5.5V41h-5c-1 0-1.5-.5-1.5-1.5 0-.8.5-1.5 1.5-1.5H33ZM49 31H37.5v25.5H45V38h1.5c1 0 3 0 3 1.5 0 2-1.5 2.5-3 2.5v6.5l3.5 8h8c-2-4-3.5-8-4.5-10.5 1.5-1 3.5-3 3.5-7 0-5.6-5.5-8-8-8ZM68 39l-2.5-8H57l11 25.5L79 31h-8.5L68 39ZM88.5 31H81v25.5h7.5V31ZM92 43.5c0-8 5.5-13 13.5-13 10.5 0 13.5 8 13.5 11h-8c0-1-2-4-5.5-4-3 0-6 2.5-6 6 0 3 2.5 6 6 6 4 0 5.333-3.333 5.5-5h8c0 7-7 12.5-13.5 12.5S92 53 92 43.5ZM136.5 38v-7H129c-3.796 0-7 3.201-7 5.5v13c0 4.4 4 7 7.5 7h7V49h-6c-1 0-1.5-.5-1.5-1.5 0-.762.5-1 1.5-1h5.5V41h-5c-.5 0-1.5-.5-1.5-1.5 0-.8 1-1.5 1.5-1.5h5.5Z"fill=#000 /><path d="M18.5 1.5h.5v-.309l-.276-.138-.224.447Zm0 7.5-.354.354.854.853V9h-.5Zm-5 9H13a.5.5 0 0 0 .621.485L13.5 18Zm0-5.5V12H13v.5h.5Zm7.5 0 .354-.354-.147-.146H21v.5Zm-6.5 15 .04.498h.01l-.05-.498Zm26-26h.5V1h-.5v.5Zm0 7V9h.5v-.5h-.5Zm-5.5 0V8h-.118l-.106.053L35 8.5Zm5.5 3h.5V11h-.5v.5Zm0 5.5v.5h.5V17h-.5Zm0 2.5h.5V19h-.5v.5Zm0 7.5v.5h.5V27h-.5Zm-7 0-.033.499.016.001h.017V27ZM26 7l-.492-.09-.008.045V7h.5Zm19-5.5V1h-.5v.5h.5ZM45 27h-.5v.5h.5V27Zm7.5 0v.5h.5V27h-.5Zm0-18.5V8H52v.5h.5Zm1.5 4V12h-.5v.5h.5Zm0 6.5h-.5v.118l.053.106L54 19Zm4 8-.447.224.138.276H58V27Zm7.5 0v.5h.758l-.298-.697-.46.197ZM61 16.5l-.29-.407-.328.234.158.37.46-.197ZM68 27h-.5v.5h.5V27Zm18.5 0v.5h.5V27h-.5ZM79 27h-.5v.5h.5V27Zm-3.5-13H75v.5h.5V14Zm2 0h.5v-.5h-.5v.5Zm0 7v.5h.5V21h-.5Zm-2 0v-.5H75v.5h.5Zm0 6v.5h.5V27h-.5ZM91 1.5V1h-.5v.5h.5Zm16 15 .354.354L107 16.5Zm4.5 10.5v.5h.809l-.362-.724-.447.224Zm-8 0-.458.2.131.3h.327V27Zm-3.5-8h-.5v.105l.042.095.458-.2Zm0-6.5V12h-.5v.5h.5Zm-1.5-4V8H98v.5h.5Zm0 18.5v.5h.5V27h-.5ZM91 27h-.5v.5h.5V27Zm23-25.5V1h-.5v.5h.5Zm0 25.5h-.5v.5h.5V27Zm7.5 0v.5h.5V27h-.5Zm0-18.5V8h-.5v.5h.5Zm1.5 11V19h-.5v.5h.5Zm0 7.5h-.5v.5h.5V27ZM14.5 38l-.121.485.621.155V38h-.5Zm0 10.5H14h.5Zm-13 .5.224-.447L1 48.19V49h.5ZM33 31h.5v-.5H33v.5Zm0 7v.5h.5V38H33Zm-.5 3h.5v-.5h-.5v.5Zm0 5.5v.5h.5v-.5h-.5ZM33 49h.5v-.5H33v.5Zm0 7.5v.5h.5v-.5H33ZM37.5 31v-.5H37v.5h.5Zm16 15-.277-.416-.338.225.15.377L53.5 46ZM58 56.5v.5h.809l-.362-.724L58 56.5Zm-8 0-.458.2.131.3H50v-.5Zm-3.5-8H46v.105l.042.095.458-.2Zm0-6.5v-.5H46v.5h.5ZM45 38v-.5h-.5v.5h.5Zm0 18.5v.5h.5v-.5H45Zm-7.5 0H37v.5h.5v-.5Zm28-25.5.477-.15-.11-.35H65.5v.5Zm2.5 8-.477.15.477 1.526.477-1.527L68 39Zm2.5-8v-.5h-.368l-.11.35.478.15Zm8.5 0 .46.198.3-.698H79v.5ZM68 56.5l-.46.198.46 1.064.46-1.064L68 56.5ZM57 31v-.5h-.76l.3.698L57 31Zm24 0v-.5h-.5v.5h.5Zm7.5 0h.5v-.5h-.5v.5Zm0 25.5v.5h.5v-.5h-.5Zm-7.5 0h-.5v.5h.5v-.5Zm38-12h.5V44h-.5v.5Zm-8 0V44h-.452l-.046.45.498.05Zm-5.5 5v.5-.5Zm5.5-8h-.5v.5h.5v-.5Zm8 0v.5h.5v-.5h-.5ZM136.5 31h.5v-.5h-.5v.5Zm0 7v.5h.5V38h-.5Zm-.5 3h.5v-.5h-.5v.5Zm0 5.5v.5h.5v-.5h-.5Zm.5 2.5h.5v-.5h-.5v.5Zm0 7.5v.5h.5v-.5h-.5Zm-7 0v.5-.5ZM129 31v.5-.5ZM18 1.5V9h1V1.5h-1Zm.854 7.146c-.246-.245-.731-.527-1.428-.748-.712-.225-1.68-.398-2.926-.398v1c1.154 0 2.02.16 2.624.352.62.196.935.414 1.022.502l.708-.708ZM14.5 7.5c-3.304 0-6 2.753-6 6.5h1c0-3.253 2.304-5.5 5-5.5v-1Zm-6 6.5c0 1.815.388 3.439 1.355 4.682.975 1.254 2.485 2.052 4.583 2.314l.124-.992c-1.902-.238-3.142-.94-3.917-1.936C9.862 17.062 9.5 15.685 9.5 14h-1Zm5.938 6.996c1.525.19 2.588-.9 2.498-2.043-.046-.585-.4-1.114-1.037-1.397-.617-.274-1.46-.306-2.52-.041l.242.97c.94-.235 1.534-.165 1.871-.015.316.14.43.357.447.562.034.434-.402 1.094-1.377.972l-.124.992ZM14 18v-5.5h-1V18h1Zm-.5-5H21v-1h-7.5v1Zm7.146-.146c1.601 1.6 2.46 4.908 1.682 7.96-.385 1.51-1.165 2.932-2.43 4.036-1.264 1.103-3.037 1.911-5.448 2.152l.1.995c2.59-.258 4.566-1.137 6.005-2.394 1.438-1.255 2.314-2.864 2.742-4.542.847-3.323-.044-7.016-1.943-8.915l-.708.708ZM14.46 27.002c-1.988.159-5.243-.322-7.988-2.225C3.758 22.894 1.5 19.592 1.5 14h-1c0 5.908 2.409 9.523 5.403 11.598 2.964 2.056 6.458 2.575 8.637 2.4l-.08-.996ZM1.5 14c0-3.28.879-5.737 2.216-7.564 1.34-1.831 3.163-3.062 5.097-3.848 1.936-.786 3.969-1.12 5.7-1.166 1.753-.046 3.123.205 3.763.525l.448-.894c-.86-.43-2.427-.679-4.237-.63-1.831.047-3.986.4-6.05 1.239-2.066.84-4.056 2.171-5.528 4.183C1.433 7.862.5 10.531.5 14h1ZM40 1.5v7h1v-7h-1Zm.5 6.5H35v1h5.5V8Zm-5.724.053c-.224.112-.531.33-.788.643-.26.316-.488.758-.488 1.304h1c0-.254.105-.479.262-.67.16-.196.353-.328.462-.383l-.448-.894ZM33.5 10c0 1.133.6 2 1.5 2v-1c-.1 0-.5-.133-.5-1h-1Zm1.5 2H40.5v-1H35v1Zm5-.5V17h1v-5.5h-1Zm.5 5H35v1h5.5v-1Zm-5.5 0c-.299 0-.754.057-1.154.25-.412.197-.846.587-.846 1.25h1c0-.137.066-.247.279-.35.225-.107.52-.15.721-.15v-1ZM33 18c0 .24 0 .493.027.718.029.23.093.484.26.707.347.462.959.575 1.713.575v-1c-.746 0-.884-.137-.913-.175-.02-.027-.05-.085-.067-.23A5.165 5.165 0 0 1 34 18h-1Zm2 2H40.5v-1H35v1Zm5-.5V27h1v-7.5h-1Zm.5 7h-7v1h7v-1Zm-6.967.001c-1.189-.08-2.976-.487-4.45-1.434C27.627 24.13 26.5 22.69 26.5 20.5h-1c0 2.61 1.373 4.335 3.042 5.408 1.651 1.061 3.614 1.503 4.925 1.59l.066-.997ZM26.5 20.5V7h-1V20.5h1Zm-.008-13.41a7.331 7.331 0 0 1 1.517-3.207C28.89 2.83 30.175 2 32 2V1c-2.175 0-3.724 1.005-4.759 2.242a8.326 8.326 0 0 0-1.733 3.669l.984.178ZM32 2H40.5V1H32v1Zm3 10h5.5v-1H35v1Zm0 8h5.5v-1H35v1Zm-8.5.5V7h-1v13.5h1ZM32 2h8.5V1H32v1Zm12.5-.5V27h1V1.5h-1Zm.5 26h7.5v-1H45v1Zm8-.5V8.5h-1V27h1Zm-.5-18H55V8h-2.5v1ZM55 9c.39 0 .787.139 1.08.353.299.22.42.462.42.647h1c0-.615-.379-1.123-.83-1.453A2.88 2.88 0 0 0 55 8v1Zm1.5 1c0 .728-.102 1.223-.312 1.53-.181.263-.5.47-1.188.47v1c.913 0 1.593-.293 2.012-.905.39-.568.488-1.323.488-2.095h-1ZM55 12h-1v1h1v-1Zm-1.5.5V19h1v-6.5h-1Zm.053 6.724 4 8 .894-.448-4-8-.894.448ZM58 27.5h7.5v-1H58v1Zm7.96-.697-4.5-10.5-.92.394 4.5 10.5.92-.394Zm-4.67-9.896C62.543 16.013 65 13.312 65 9.5h-1c0 3.388-2.208 5.82-3.29 6.593l.58.814ZM65 9.5C65 4.768 61.818 1 57 1v1c4.182 0 7 3.232 7 7.5h1ZM57 1H45v1h12V1Zm11.5 26V8.5h-1V27h1Zm0-18.5c0-1.577.89-3.453 2.491-4.947A9.504 9.504 0 0 1 77.5 1V0a10.504 10.504 0 0 0-7.191 2.822C68.56 4.452 67.5 6.577 67.5 8.5h1Zm9-7.5c3.335 0 5.444 1.42 6.732 3.059C85.54 5.724 86 7.616 86 8.5h1c0-1.116-.54-3.224-1.982-5.059C83.556 1.581 81.165 0 77.5 0v1ZM86 8.5V27h1V8.5h-1Zm.5 18H79v1h7.5v-1Zm-7 .5V9.5h-1V27h1Zm0-17.5c0-.625-.223-1.14-.614-1.495-.383-.348-.885-.505-1.386-.505v1c.299 0 .547.093.714.245.159.145.286.38.286.755h1Zm-2-2c-.574 0-1.177.142-1.652.459-.49.327-.848.847-.848 1.541h1c0-.306.143-.536.402-.709.275-.183.672-.291 1.098-.291v-1Zm-2.5 2V14h1V9.5h-1Zm.5 5h2v-1h-2v1ZM77 14v7h1v-7h-1Zm.5 6.5h-2v1h2v-1ZM75 21v6h1v-6h-1Zm.5 5.5H68v1h7.5v-1ZM91 2h12V1H91v1Zm12 0c1.637 0 3.388.586 4.725 1.807C109.053 5.019 110 6.88 110 9.5h1c0-2.881-1.053-5.019-2.6-6.432C106.862 1.664 104.863 1 103 1v1Zm7 7.5c0 2.651-.72 4.16-1.451 5.06a5.361 5.361 0 0 1-1.081 1.001c-.167.119-.314.213-.45.303-.12.08-.267.178-.372.282l.708.708c.02-.02.076-.063.216-.156.123-.082.293-.19.478-.322.375-.267.834-.64 1.278-1.186.894-1.1 1.674-2.841 1.674-5.69h-1Zm-3.354 6.646a.62.62 0 0 0-.161.3.854.854 0 0 0-.018.216c.003.12.026.253.056.38.061.26.169.594.308.971.279.76.703 1.76 1.188 2.841.97 2.168 2.199 4.7 3.034 6.37l.894-.448a181.494 181.494 0 0 1-3.016-6.33c-.482-1.077-.895-2.052-1.162-2.778a7.824 7.824 0 0 1-.272-.852 1.191 1.191 0 0 1-.031-.183c0-.012.002.003-.005.033a.394.394 0 0 1-.107.188l-.708-.708ZM111.5 26.5h-8v1h8v-1Zm-7.542.3-3.5-8-.916.4 3.5 8 .916-.4ZM100.5 19v-6.5h-1V19h1Zm-.5-6c.79 0 1.657-.129 2.34-.584.718-.479 1.16-1.27 1.16-2.416h-1c0 .854-.308 1.313-.715 1.584-.442.295-1.075.416-1.785.416v1Zm3.5-3c0-.686-.348-1.194-.75-1.515-.386-.31-.868-.485-1.25-.485v1c.118 0 .386.074.625.265.223.179.375.42.375.735h1Zm-2-2h-3v1h3V8Zm-3.5.5V27h1V8.5h-1Zm.5 18H91v1h7.5v-1Zm-7 .5V1.5h-1V27h1Zm22-25.5V27h1V1.5h-1Zm.5 26h7.5v-1H114v1Zm8-.5V8.5h-1V27h1Zm-.5-18h4.5V8h-4.5v1Zm4.5 0c2.206 0 4.5 2.057 4.5 5h1c0-3.457-2.706-6-5.5-6v1Zm4.5 5c0 2.789-1.837 5-4.5 5v1c3.337 0 5.5-2.789 5.5-6h-1Zm-4.5 5h-3v1h3v-1Zm-3.5.5V27h1v-7.5h-1Zm.5 8h3v-1h-3v1Zm3 0c2.112 0 5.345-.887 8.058-3.006C136.791 22.36 139 18.97 139 14h-1c0 4.63-2.041 7.74-4.558 9.706-2.537 1.982-5.554 2.794-7.442 2.794v1ZM139 14c0-5.697-2.736-8.974-5.74-10.802C130.289 1.39 127.069 1 126 1v1c.931 0 3.961.36 6.74 2.052C135.486 5.724 138 8.697 138 14h1ZM126 1h-12v1h12V1ZM14 31v7h1v-7h-1Zm.621 6.515c-1.067-.267-1.965-.213-2.62.164-.68.39-1.001 1.072-1.001 1.821h1c0-.45.178-.77.5-.954.344-.198.946-.294 1.879-.06l.242-.971ZM11 39.5c0 .722.216 1.428.509 2.114.29.682.68 1.394 1.047 2.105C13.302 45.167 14 46.699 14 48.5h1c0-2.06-.802-3.778-1.556-5.24-.383-.743-.744-1.4-1.015-2.038-.27-.633-.429-1.194-.429-1.722h-1Zm3 9c0 1.823-1.035 3.826-2.66 5.39C9.72 55.45 7.59 56.5 5.5 56.5v1c2.411 0 4.78-1.2 6.534-2.89C13.785 52.924 15 50.677 15 48.5h-1Zm-8.5 8c-.963 0-1.922-.121-2.629-.298a3.643 3.643 0 0 1-.791-.276.569.569 0 0 1-.128-.084c-.009-.01.048.045.048.158H1c0 .238.12.418.228.531.109.115.246.205.38.277.27.145.627.266 1.02.365.794.198 1.835.327 2.872.327v-1ZM2 56v-7H1v7h1Zm-.724-6.553c.368.184 1.315.553 2.224.553v-1c-.691 0-1.478-.298-1.776-.447l-.448.894ZM3.5 50c.568 0 1.292-.14 1.89-.514.62-.387 1.11-1.035 1.11-1.986h-1c0 .55-.26.901-.64 1.139-.402.25-.929.361-1.36.361v1Zm3-2.5c0-.22-.076-.473-.159-.701-.089-.245-.213-.531-.355-.842-.293-.644-.651-1.373-1.03-2.223-.749-1.686-1.456-3.6-1.456-5.234h-1c0 1.866.793 3.952 1.543 5.64.372.838.764 1.64 1.033 2.231.14.306.25.563.325.77.081.222.099.33.099.359h1Zm-3-9c0-1.598.808-3.482 2.18-4.974C7.048 32.04 8.922 31 11 31v-1c-2.422 0-4.548 1.21-6.055 2.849C3.442 34.482 2.5 36.598 2.5 38.5h1ZM11 31c1.01 0 1.856 0 2.45.06.302.03.493.072.595.114.119.048-.045.018-.045-.174h1c0-.442-.351-.66-.576-.752-.242-.099-.551-.15-.874-.183C12.894 29.999 11.99 30 11 30v1Zm21.5 0v7h1v-7h-1Zm.5 6.5h-5.5v1H33v-1Zm-5.5 0c-.625 0-1.14.223-1.495.614-.348.383-.505.885-.505 1.386h1c0-.299.093-.547.245-.714.145-.159.38-.286.755-.286v-1Zm-2 2c0 .577.145 1.102.521 1.479.377.376.902.521 1.479.521v-1c-.423 0-.648-.105-.771-.229-.124-.123-.229-.348-.229-.771h-1Zm2 2h5v-1h-5v1ZM32 41v5.5h1V41h-1Zm.5 5H27v1h5.5v-1ZM27 46c-.299 0-.754.057-1.154.25-.412.197-.846.587-.846 1.25h1c0-.137.066-.247.279-.35.225-.107.52-.15.721-.15v-1Zm-2 1.5c0 .577.145 1.102.521 1.479.377.376.902.521 1.479.521v-1c-.423 0-.648-.105-.771-.229-.124-.123-.229-.348-.229-.771h-1Zm2 2h6v-1h-6v1Zm5.5-.5v7.5h1V49h-1Zm.5 7h-7.5v1H33v-1Zm-7.5 0c-1.115 0-2.76-.572-4.13-1.644C20.01 53.291 19 51.797 19 50h-1c0 2.203 1.24 3.959 2.754 5.144C22.26 56.322 24.115 57 25.5 57v-1ZM19 50V37h-1v13h1Zm0-13c0-.907.488-2.289 1.566-3.449C21.628 32.41 23.25 31.5 25.5 31.5v-1c-2.549 0-4.428 1.039-5.666 2.37C18.612 34.185 18 35.803 18 37h1Zm6.5-5.5H33v-1h-7.5v1Zm12 0H49v-1H37.5v1Zm11.5 0c1.127 0 3.022.556 4.632 1.796C55.224 34.522 56.5 36.386 56.5 39h1c0-2.986-1.474-5.122-3.257-6.496-1.765-1.36-3.87-2.004-5.243-2.004v1Zm7.5 7.5c0 3.792-1.879 5.651-3.277 6.584l.554.832C55.38 45.349 57.5 43.208 57.5 39h-1Zm-3.464 7.186c.995 2.488 2.505 6.514 4.517 10.538l.894-.448c-1.988-3.976-3.478-7.95-4.483-10.462l-.928.372ZM58 56h-8v1h8v-1Zm-7.542.3-3.5-8-.916.4 3.5 8 .916-.4ZM47 48.5V42h-1v6.5h1Zm-.5-6c.79 0 1.657-.129 2.34-.584.718-.479 1.16-1.27 1.16-2.416h-1c0 .854-.309 1.313-.715 1.584-.442.295-1.075.416-1.785.416v1Zm3.5-3c0-.499-.171-.906-.468-1.214-.284-.295-.655-.47-1.013-.577-.708-.213-1.533-.209-2.019-.209v1c.514 0 1.189.004 1.731.166.267.08.459.187.58.314.11.114.189.269.189.52h1Zm-3.5-2H45v1h1.5v-1Zm-2 .5v18.5h1V38h-1Zm.5 18h-7.5v1H45v-1Zm-7 .5V31h-1v25.5h1Zm27.023-25.35 2.5 8 .954-.3-2.5-8-.954.3Zm3.454 8 2.5-8-.954-.3-2.5 8 .954.3ZM70.5 31.5H79v-1h-8.5v1Zm8.04-.698-11 25.5.92.396 11-25.5-.92-.396Zm-10.08 25.5-11-25.5-.92.396 11 25.5.92-.396ZM57 31.5h8.5v-1H57v1Zm24 0h7.5v-1H81v1Zm7-.5v25.5h1V31h-1Zm.5 25H81v1h7.5v-1Zm-7 .5V31h-1v25.5h1Zm24-26.5c-4.104 0-7.61 1.284-10.094 3.637C92.92 35.993 91.5 39.381 91.5 43.5h1c0-3.88 1.33-6.993 3.594-9.137C98.36 32.216 101.604 31 105.5 31v-1Zm-14 13.5c0 4.885 1.806 8.403 4.488 10.693 2.67 2.279 6.166 3.307 9.512 3.307v-1c-3.154 0-6.407-.971-8.863-3.068-2.443-2.085-4.137-5.317-4.137-9.932h-1Zm14 14c3.384 0 6.874-1.428 9.517-3.75 2.646-2.323 4.483-5.576 4.483-9.25h-1c0 3.326-1.663 6.323-4.142 8.5-2.482 2.178-5.742 3.5-8.858 3.5v1ZM119 44h-8v1h8v-1Zm-8.498.45a5.625 5.625 0 0 1-1.201 2.858c-.766.934-1.961 1.692-3.801 1.692v1c2.16 0 3.632-.909 4.574-2.058a6.636 6.636 0 0 0 1.424-3.392l-.996-.1ZM105.5 49c-3.197 0-5.5-2.749-5.5-5.5h-1c0 3.249 2.697 6.5 6.5 6.5v-1Zm-5.5-5.5c0-3.197 2.749-5.5 5.5-5.5v-1c-3.249 0-6.5 2.697-6.5 6.5h1Zm5.5-5.5c1.599 0 2.857.683 3.721 1.49.433.405.761.834.978 1.212.227.396.301.679.301.798h1c0-.38-.176-.848-.434-1.296a6.315 6.315 0 0 0-1.162-1.444c-1.011-.943-2.503-1.76-4.404-1.76v1Zm5.5 4h8v-1h-8v1Zm8.5-.5c0-1.624-.796-4.49-2.935-6.953C114.406 32.062 110.893 30 105.5 30v1c5.107 0 8.344 1.938 10.31 4.203 1.986 2.287 2.69 4.921 2.69 6.297h1ZM136 31v7h1v-7h-1Zm.5 6.5H131v1h5.5v-1Zm-5.5 0a1.58 1.58 0 0 0-.66.17 2.683 2.683 0 0 0-.608.405c-.364.32-.732.82-.732 1.425h1c0-.195.132-.445.393-.675.123-.108.256-.194.377-.252a.647.647 0 0 1 .23-.073v-1Zm-2 2c0 .686.348 1.194.75 1.515.386.31.868.485 1.25.485v-1c-.118 0-.386-.074-.625-.265-.223-.179-.375-.42-.375-.735h-1Zm2 2h5v-1h-5v1Zm4.5-.5v5.5h1V41h-1Zm.5 5h-5.5v1h5.5v-1Zm-5.5 0c-.515 0-1.012.056-1.388.29-.433.267-.612.703-.612 1.21h1c0-.255.071-.32.138-.36.124-.077.377-.14.862-.14v-1Zm-2 1.5c0 .577.145 1.102.521 1.479.377.376.902.521 1.479.521v-1c-.423 0-.648-.105-.771-.229-.124-.123-.229-.348-.229-.771h-1Zm2 2h6v-1h-6v1Zm5.5-.5v7.5h1V49h-1Zm.5 7h-7v1h7v-1Zm-7 0c-3.312 0-7-2.457-7-6.5h-1c0 4.757 4.312 7.5 8 7.5v-1Zm-7-6.5v-13h-1v13h1Zm0-13c0-.943.681-2.191 1.901-3.232 1.202-1.024 2.84-1.768 4.599-1.768v-1c-2.037 0-3.899.857-5.248 2.008-1.331 1.135-2.252 2.636-2.252 3.992h1Zm6.5-5h7.5v-1H129v1Z"fill=#000 /></svg></div><div><div class=invoice__info><b>DUEÑO :</b> <span>Gerardo Lopez</span></div><div class=invoice__info><b>RUC :</b> <span>10092915447</span></div><div class=invoice__info><b>TELF / YAPE :</b> <span>994 012 698</span></div><div class=invoice__info><b>DIRECCIÓN :</b> <span>Av. Cesar Canevaro 806, Lince, Lima</span></div><div class=invoice__info><b>BCP :</b> <span>19392550347097</span></div><div class=invoice__info><b>CCI :</b> <span>00219319255034709710</span></div></div><div class=invoice__id><b>ORDEN DE TRABAJO</b> <span><b>N°:</b> <span><%= it.id %></span></span></div></div><div class=invoice__row2><div class=invoice__ctnr1><div class=invoice__info><b>NOMBRE :</b> <span><%= it.name %></span></div><div class=invoice__info><b>DIRECCIÓN :</b> <span><%= it.address %></span></div><div class=invoice__info><b>D.N.I :</b> <span><%= it.dni %></span></div><div class=invoice__info><b>R.U.C :</b> <span><%= it.ruc %></span></div><div class=invoice__info><b>FECHA EMISIÓN :</b> <span><%= it.date %></span></div></div><div class=invoice__ctnr1><div class=invoice__info><b>MARCA :</b> <span><%= it.brand %></span></div><div class=invoice__info><b>MODELO :</b> <span><%= it.model %></span></div><div class=invoice__info><b>COLOR :</b> <span><%= it.color %></span></div><div class=invoice__info><b>PLACA :</b> <span><%= it.plate %></span></div><div class=invoice__info><b>KILOMETRAJE :</b> <span><%= it.mileage %></span></div></div></div><div class=invoice__row3><table class=invoice__table><thead><tr><th>CÓDIGO<th>CANTIDAD<th style=width:50%>DESCRIPCIÓN<th>P. UNITARIO<th>P. TOTAL<tbody><% it.items.forEach(function(item){ %><tr><td><%= item.code %><td><%= item.quantity %><td><%= item.description %><td><%= item.punit %><td><%= item.ptotal %></tr><% }) %></table></div><div class=invoice__row4><div class=invoice__observation><b>OBSERVACIONES:</b> <span><%= it.observation %></span></div><div class=invoice__total><div class=invoice__ctnr2><div class=invoice__amount><b>SUBTOTAL :</b> <span>S/.<%= it.subtotal %></span></div><div class=invoice__amount><b>I.G.V :</b> <span>S/. 00.00</span></div></div><div class=invoice__ctnr3><b>TOTAL:</b> <span style=float:right>S/.<%= it.total %></span></div></div></div>
`

const clipboardTemplate = `
<div class=invoice id=a4><div class=invoice__row1><div class=invoice__logo><svg class=invoice__svg viewBox="0 0 139 58"xmlns=http://www.w3.org/2000/svg><path d="M18.5 1.5V9c-.333-.333-1.6-1-4-1-3 0-5.5 2.5-5.5 6s1.5 6 5.5 6.5c2.5.313 3-3.5-1-2.5v-5.5H21c3.5 3.5 3.5 14-6.5 15C10.333 27.833 1 25.5 1 14 1 .5 15.5 0 18.5 1.5ZM40.5 1.5v7H35c-.333.167-1 .7-1 1.5 0 1 .5 1.5 1 1.5h5.5V17H35c-.5 0-1.5.2-1.5 1 0 1 0 1.5 1.5 1.5h5.5V27h-7c-2.5-.167-7.5-1.7-7.5-6.5V7c.333-1.833 2-5.5 6-5.5h8.5ZM45 27V1.5h12c4.5 0 7.5 3.5 7.5 8 0 3.6-2.333 6.167-3.5 7L65.5 27H58l-4-8v-6.5h1c1.6 0 2-1 2-2.5 0-.8-1-1.5-2-1.5h-2.5V27H45ZM68 8.5V27h7.5v-6h2v-7h-2V9.5c0-1 1-1.5 2-1.5.8 0 1.5.5 1.5 1.5V27h7.5V8.5c0-2-2-8-9-8C71.9.5 68 5 68 8.5ZM103 1.5H91V27h7.5V8.5h3c.5 0 1.5.5 1.5 1.5 0 2-1.5 2.5-3 2.5V19l3.5 8h8c-1.667-3.333-4.9-10.1-4.5-10.5.5-.5 3.5-1.5 3.5-7s-4-8-7.5-8ZM114 27V1.5h12c2 0 12.5 1.5 12.5 12.5 0 9.6-8.5 13-12.5 13h-3v-7.5h3c3 0 5-2.5 5-5.5 0-3.2-2.5-5.5-5-5.5h-4.5V27H114ZM14.5 38v-7c0-.5-1.5-.5-3.5-.5-4.5 0-8 4.5-8 8s3 8 3 9c0 1.5-1.5 2-2.5 2-.8 0-1.667-.333-2-.5v7c0 .5 2 1 4 1 4.5 0 9-4.5 9-8.5 0-3.86-3-6.5-3-9 0-1.2 1-2 3-1.5ZM33 38v-7h-7.5c-4.8 0-7 3.896-7 6v13c0 4 4.5 6.5 7 6.5H33V49h-6c-1 0-1.5-.5-1.5-1.5 0-.8 1-1 1.5-1h5.5V41h-5c-1 0-1.5-.5-1.5-1.5 0-.8.5-1.5 1.5-1.5H33ZM49 31H37.5v25.5H45V38h1.5c1 0 3 0 3 1.5 0 2-1.5 2.5-3 2.5v6.5l3.5 8h8c-2-4-3.5-8-4.5-10.5 1.5-1 3.5-3 3.5-7 0-5.6-5.5-8-8-8ZM68 39l-2.5-8H57l11 25.5L79 31h-8.5L68 39ZM88.5 31H81v25.5h7.5V31ZM92 43.5c0-8 5.5-13 13.5-13 10.5 0 13.5 8 13.5 11h-8c0-1-2-4-5.5-4-3 0-6 2.5-6 6 0 3 2.5 6 6 6 4 0 5.333-3.333 5.5-5h8c0 7-7 12.5-13.5 12.5S92 53 92 43.5ZM136.5 38v-7H129c-3.796 0-7 3.201-7 5.5v13c0 4.4 4 7 7.5 7h7V49h-6c-1 0-1.5-.5-1.5-1.5 0-.762.5-1 1.5-1h5.5V41h-5c-.5 0-1.5-.5-1.5-1.5 0-.8 1-1.5 1.5-1.5h5.5Z"fill=#000 /><path d="M18.5 1.5h.5v-.309l-.276-.138-.224.447Zm0 7.5-.354.354.854.853V9h-.5Zm-5 9H13a.5.5 0 0 0 .621.485L13.5 18Zm0-5.5V12H13v.5h.5Zm7.5 0 .354-.354-.147-.146H21v.5Zm-6.5 15 .04.498h.01l-.05-.498Zm26-26h.5V1h-.5v.5Zm0 7V9h.5v-.5h-.5Zm-5.5 0V8h-.118l-.106.053L35 8.5Zm5.5 3h.5V11h-.5v.5Zm0 5.5v.5h.5V17h-.5Zm0 2.5h.5V19h-.5v.5Zm0 7.5v.5h.5V27h-.5Zm-7 0-.033.499.016.001h.017V27ZM26 7l-.492-.09-.008.045V7h.5Zm19-5.5V1h-.5v.5h.5ZM45 27h-.5v.5h.5V27Zm7.5 0v.5h.5V27h-.5Zm0-18.5V8H52v.5h.5Zm1.5 4V12h-.5v.5h.5Zm0 6.5h-.5v.118l.053.106L54 19Zm4 8-.447.224.138.276H58V27Zm7.5 0v.5h.758l-.298-.697-.46.197ZM61 16.5l-.29-.407-.328.234.158.37.46-.197ZM68 27h-.5v.5h.5V27Zm18.5 0v.5h.5V27h-.5ZM79 27h-.5v.5h.5V27Zm-3.5-13H75v.5h.5V14Zm2 0h.5v-.5h-.5v.5Zm0 7v.5h.5V21h-.5Zm-2 0v-.5H75v.5h.5Zm0 6v.5h.5V27h-.5ZM91 1.5V1h-.5v.5h.5Zm16 15 .354.354L107 16.5Zm4.5 10.5v.5h.809l-.362-.724-.447.224Zm-8 0-.458.2.131.3h.327V27Zm-3.5-8h-.5v.105l.042.095.458-.2Zm0-6.5V12h-.5v.5h.5Zm-1.5-4V8H98v.5h.5Zm0 18.5v.5h.5V27h-.5ZM91 27h-.5v.5h.5V27Zm23-25.5V1h-.5v.5h.5Zm0 25.5h-.5v.5h.5V27Zm7.5 0v.5h.5V27h-.5Zm0-18.5V8h-.5v.5h.5Zm1.5 11V19h-.5v.5h.5Zm0 7.5h-.5v.5h.5V27ZM14.5 38l-.121.485.621.155V38h-.5Zm0 10.5H14h.5Zm-13 .5.224-.447L1 48.19V49h.5ZM33 31h.5v-.5H33v.5Zm0 7v.5h.5V38H33Zm-.5 3h.5v-.5h-.5v.5Zm0 5.5v.5h.5v-.5h-.5ZM33 49h.5v-.5H33v.5Zm0 7.5v.5h.5v-.5H33ZM37.5 31v-.5H37v.5h.5Zm16 15-.277-.416-.338.225.15.377L53.5 46ZM58 56.5v.5h.809l-.362-.724L58 56.5Zm-8 0-.458.2.131.3H50v-.5Zm-3.5-8H46v.105l.042.095.458-.2Zm0-6.5v-.5H46v.5h.5ZM45 38v-.5h-.5v.5h.5Zm0 18.5v.5h.5v-.5H45Zm-7.5 0H37v.5h.5v-.5Zm28-25.5.477-.15-.11-.35H65.5v.5Zm2.5 8-.477.15.477 1.526.477-1.527L68 39Zm2.5-8v-.5h-.368l-.11.35.478.15Zm8.5 0 .46.198.3-.698H79v.5ZM68 56.5l-.46.198.46 1.064.46-1.064L68 56.5ZM57 31v-.5h-.76l.3.698L57 31Zm24 0v-.5h-.5v.5h.5Zm7.5 0h.5v-.5h-.5v.5Zm0 25.5v.5h.5v-.5h-.5Zm-7.5 0h-.5v.5h.5v-.5Zm38-12h.5V44h-.5v.5Zm-8 0V44h-.452l-.046.45.498.05Zm-5.5 5v.5-.5Zm5.5-8h-.5v.5h.5v-.5Zm8 0v.5h.5v-.5h-.5ZM136.5 31h.5v-.5h-.5v.5Zm0 7v.5h.5V38h-.5Zm-.5 3h.5v-.5h-.5v.5Zm0 5.5v.5h.5v-.5h-.5Zm.5 2.5h.5v-.5h-.5v.5Zm0 7.5v.5h.5v-.5h-.5Zm-7 0v.5-.5ZM129 31v.5-.5ZM18 1.5V9h1V1.5h-1Zm.854 7.146c-.246-.245-.731-.527-1.428-.748-.712-.225-1.68-.398-2.926-.398v1c1.154 0 2.02.16 2.624.352.62.196.935.414 1.022.502l.708-.708ZM14.5 7.5c-3.304 0-6 2.753-6 6.5h1c0-3.253 2.304-5.5 5-5.5v-1Zm-6 6.5c0 1.815.388 3.439 1.355 4.682.975 1.254 2.485 2.052 4.583 2.314l.124-.992c-1.902-.238-3.142-.94-3.917-1.936C9.862 17.062 9.5 15.685 9.5 14h-1Zm5.938 6.996c1.525.19 2.588-.9 2.498-2.043-.046-.585-.4-1.114-1.037-1.397-.617-.274-1.46-.306-2.52-.041l.242.97c.94-.235 1.534-.165 1.871-.015.316.14.43.357.447.562.034.434-.402 1.094-1.377.972l-.124.992ZM14 18v-5.5h-1V18h1Zm-.5-5H21v-1h-7.5v1Zm7.146-.146c1.601 1.6 2.46 4.908 1.682 7.96-.385 1.51-1.165 2.932-2.43 4.036-1.264 1.103-3.037 1.911-5.448 2.152l.1.995c2.59-.258 4.566-1.137 6.005-2.394 1.438-1.255 2.314-2.864 2.742-4.542.847-3.323-.044-7.016-1.943-8.915l-.708.708ZM14.46 27.002c-1.988.159-5.243-.322-7.988-2.225C3.758 22.894 1.5 19.592 1.5 14h-1c0 5.908 2.409 9.523 5.403 11.598 2.964 2.056 6.458 2.575 8.637 2.4l-.08-.996ZM1.5 14c0-3.28.879-5.737 2.216-7.564 1.34-1.831 3.163-3.062 5.097-3.848 1.936-.786 3.969-1.12 5.7-1.166 1.753-.046 3.123.205 3.763.525l.448-.894c-.86-.43-2.427-.679-4.237-.63-1.831.047-3.986.4-6.05 1.239-2.066.84-4.056 2.171-5.528 4.183C1.433 7.862.5 10.531.5 14h1ZM40 1.5v7h1v-7h-1Zm.5 6.5H35v1h5.5V8Zm-5.724.053c-.224.112-.531.33-.788.643-.26.316-.488.758-.488 1.304h1c0-.254.105-.479.262-.67.16-.196.353-.328.462-.383l-.448-.894ZM33.5 10c0 1.133.6 2 1.5 2v-1c-.1 0-.5-.133-.5-1h-1Zm1.5 2H40.5v-1H35v1Zm5-.5V17h1v-5.5h-1Zm.5 5H35v1h5.5v-1Zm-5.5 0c-.299 0-.754.057-1.154.25-.412.197-.846.587-.846 1.25h1c0-.137.066-.247.279-.35.225-.107.52-.15.721-.15v-1ZM33 18c0 .24 0 .493.027.718.029.23.093.484.26.707.347.462.959.575 1.713.575v-1c-.746 0-.884-.137-.913-.175-.02-.027-.05-.085-.067-.23A5.165 5.165 0 0 1 34 18h-1Zm2 2H40.5v-1H35v1Zm5-.5V27h1v-7.5h-1Zm.5 7h-7v1h7v-1Zm-6.967.001c-1.189-.08-2.976-.487-4.45-1.434C27.627 24.13 26.5 22.69 26.5 20.5h-1c0 2.61 1.373 4.335 3.042 5.408 1.651 1.061 3.614 1.503 4.925 1.59l.066-.997ZM26.5 20.5V7h-1V20.5h1Zm-.008-13.41a7.331 7.331 0 0 1 1.517-3.207C28.89 2.83 30.175 2 32 2V1c-2.175 0-3.724 1.005-4.759 2.242a8.326 8.326 0 0 0-1.733 3.669l.984.178ZM32 2H40.5V1H32v1Zm3 10h5.5v-1H35v1Zm0 8h5.5v-1H35v1Zm-8.5.5V7h-1v13.5h1ZM32 2h8.5V1H32v1Zm12.5-.5V27h1V1.5h-1Zm.5 26h7.5v-1H45v1Zm8-.5V8.5h-1V27h1Zm-.5-18H55V8h-2.5v1ZM55 9c.39 0 .787.139 1.08.353.299.22.42.462.42.647h1c0-.615-.379-1.123-.83-1.453A2.88 2.88 0 0 0 55 8v1Zm1.5 1c0 .728-.102 1.223-.312 1.53-.181.263-.5.47-1.188.47v1c.913 0 1.593-.293 2.012-.905.39-.568.488-1.323.488-2.095h-1ZM55 12h-1v1h1v-1Zm-1.5.5V19h1v-6.5h-1Zm.053 6.724 4 8 .894-.448-4-8-.894.448ZM58 27.5h7.5v-1H58v1Zm7.96-.697-4.5-10.5-.92.394 4.5 10.5.92-.394Zm-4.67-9.896C62.543 16.013 65 13.312 65 9.5h-1c0 3.388-2.208 5.82-3.29 6.593l.58.814ZM65 9.5C65 4.768 61.818 1 57 1v1c4.182 0 7 3.232 7 7.5h1ZM57 1H45v1h12V1Zm11.5 26V8.5h-1V27h1Zm0-18.5c0-1.577.89-3.453 2.491-4.947A9.504 9.504 0 0 1 77.5 1V0a10.504 10.504 0 0 0-7.191 2.822C68.56 4.452 67.5 6.577 67.5 8.5h1Zm9-7.5c3.335 0 5.444 1.42 6.732 3.059C85.54 5.724 86 7.616 86 8.5h1c0-1.116-.54-3.224-1.982-5.059C83.556 1.581 81.165 0 77.5 0v1ZM86 8.5V27h1V8.5h-1Zm.5 18H79v1h7.5v-1Zm-7 .5V9.5h-1V27h1Zm0-17.5c0-.625-.223-1.14-.614-1.495-.383-.348-.885-.505-1.386-.505v1c.299 0 .547.093.714.245.159.145.286.38.286.755h1Zm-2-2c-.574 0-1.177.142-1.652.459-.49.327-.848.847-.848 1.541h1c0-.306.143-.536.402-.709.275-.183.672-.291 1.098-.291v-1Zm-2.5 2V14h1V9.5h-1Zm.5 5h2v-1h-2v1ZM77 14v7h1v-7h-1Zm.5 6.5h-2v1h2v-1ZM75 21v6h1v-6h-1Zm.5 5.5H68v1h7.5v-1ZM91 2h12V1H91v1Zm12 0c1.637 0 3.388.586 4.725 1.807C109.053 5.019 110 6.88 110 9.5h1c0-2.881-1.053-5.019-2.6-6.432C106.862 1.664 104.863 1 103 1v1Zm7 7.5c0 2.651-.72 4.16-1.451 5.06a5.361 5.361 0 0 1-1.081 1.001c-.167.119-.314.213-.45.303-.12.08-.267.178-.372.282l.708.708c.02-.02.076-.063.216-.156.123-.082.293-.19.478-.322.375-.267.834-.64 1.278-1.186.894-1.1 1.674-2.841 1.674-5.69h-1Zm-3.354 6.646a.62.62 0 0 0-.161.3.854.854 0 0 0-.018.216c.003.12.026.253.056.38.061.26.169.594.308.971.279.76.703 1.76 1.188 2.841.97 2.168 2.199 4.7 3.034 6.37l.894-.448a181.494 181.494 0 0 1-3.016-6.33c-.482-1.077-.895-2.052-1.162-2.778a7.824 7.824 0 0 1-.272-.852 1.191 1.191 0 0 1-.031-.183c0-.012.002.003-.005.033a.394.394 0 0 1-.107.188l-.708-.708ZM111.5 26.5h-8v1h8v-1Zm-7.542.3-3.5-8-.916.4 3.5 8 .916-.4ZM100.5 19v-6.5h-1V19h1Zm-.5-6c.79 0 1.657-.129 2.34-.584.718-.479 1.16-1.27 1.16-2.416h-1c0 .854-.308 1.313-.715 1.584-.442.295-1.075.416-1.785.416v1Zm3.5-3c0-.686-.348-1.194-.75-1.515-.386-.31-.868-.485-1.25-.485v1c.118 0 .386.074.625.265.223.179.375.42.375.735h1Zm-2-2h-3v1h3V8Zm-3.5.5V27h1V8.5h-1Zm.5 18H91v1h7.5v-1Zm-7 .5V1.5h-1V27h1Zm22-25.5V27h1V1.5h-1Zm.5 26h7.5v-1H114v1Zm8-.5V8.5h-1V27h1Zm-.5-18h4.5V8h-4.5v1Zm4.5 0c2.206 0 4.5 2.057 4.5 5h1c0-3.457-2.706-6-5.5-6v1Zm4.5 5c0 2.789-1.837 5-4.5 5v1c3.337 0 5.5-2.789 5.5-6h-1Zm-4.5 5h-3v1h3v-1Zm-3.5.5V27h1v-7.5h-1Zm.5 8h3v-1h-3v1Zm3 0c2.112 0 5.345-.887 8.058-3.006C136.791 22.36 139 18.97 139 14h-1c0 4.63-2.041 7.74-4.558 9.706-2.537 1.982-5.554 2.794-7.442 2.794v1ZM139 14c0-5.697-2.736-8.974-5.74-10.802C130.289 1.39 127.069 1 126 1v1c.931 0 3.961.36 6.74 2.052C135.486 5.724 138 8.697 138 14h1ZM126 1h-12v1h12V1ZM14 31v7h1v-7h-1Zm.621 6.515c-1.067-.267-1.965-.213-2.62.164-.68.39-1.001 1.072-1.001 1.821h1c0-.45.178-.77.5-.954.344-.198.946-.294 1.879-.06l.242-.971ZM11 39.5c0 .722.216 1.428.509 2.114.29.682.68 1.394 1.047 2.105C13.302 45.167 14 46.699 14 48.5h1c0-2.06-.802-3.778-1.556-5.24-.383-.743-.744-1.4-1.015-2.038-.27-.633-.429-1.194-.429-1.722h-1Zm3 9c0 1.823-1.035 3.826-2.66 5.39C9.72 55.45 7.59 56.5 5.5 56.5v1c2.411 0 4.78-1.2 6.534-2.89C13.785 52.924 15 50.677 15 48.5h-1Zm-8.5 8c-.963 0-1.922-.121-2.629-.298a3.643 3.643 0 0 1-.791-.276.569.569 0 0 1-.128-.084c-.009-.01.048.045.048.158H1c0 .238.12.418.228.531.109.115.246.205.38.277.27.145.627.266 1.02.365.794.198 1.835.327 2.872.327v-1ZM2 56v-7H1v7h1Zm-.724-6.553c.368.184 1.315.553 2.224.553v-1c-.691 0-1.478-.298-1.776-.447l-.448.894ZM3.5 50c.568 0 1.292-.14 1.89-.514.62-.387 1.11-1.035 1.11-1.986h-1c0 .55-.26.901-.64 1.139-.402.25-.929.361-1.36.361v1Zm3-2.5c0-.22-.076-.473-.159-.701-.089-.245-.213-.531-.355-.842-.293-.644-.651-1.373-1.03-2.223-.749-1.686-1.456-3.6-1.456-5.234h-1c0 1.866.793 3.952 1.543 5.64.372.838.764 1.64 1.033 2.231.14.306.25.563.325.77.081.222.099.33.099.359h1Zm-3-9c0-1.598.808-3.482 2.18-4.974C7.048 32.04 8.922 31 11 31v-1c-2.422 0-4.548 1.21-6.055 2.849C3.442 34.482 2.5 36.598 2.5 38.5h1ZM11 31c1.01 0 1.856 0 2.45.06.302.03.493.072.595.114.119.048-.045.018-.045-.174h1c0-.442-.351-.66-.576-.752-.242-.099-.551-.15-.874-.183C12.894 29.999 11.99 30 11 30v1Zm21.5 0v7h1v-7h-1Zm.5 6.5h-5.5v1H33v-1Zm-5.5 0c-.625 0-1.14.223-1.495.614-.348.383-.505.885-.505 1.386h1c0-.299.093-.547.245-.714.145-.159.38-.286.755-.286v-1Zm-2 2c0 .577.145 1.102.521 1.479.377.376.902.521 1.479.521v-1c-.423 0-.648-.105-.771-.229-.124-.123-.229-.348-.229-.771h-1Zm2 2h5v-1h-5v1ZM32 41v5.5h1V41h-1Zm.5 5H27v1h5.5v-1ZM27 46c-.299 0-.754.057-1.154.25-.412.197-.846.587-.846 1.25h1c0-.137.066-.247.279-.35.225-.107.52-.15.721-.15v-1Zm-2 1.5c0 .577.145 1.102.521 1.479.377.376.902.521 1.479.521v-1c-.423 0-.648-.105-.771-.229-.124-.123-.229-.348-.229-.771h-1Zm2 2h6v-1h-6v1Zm5.5-.5v7.5h1V49h-1Zm.5 7h-7.5v1H33v-1Zm-7.5 0c-1.115 0-2.76-.572-4.13-1.644C20.01 53.291 19 51.797 19 50h-1c0 2.203 1.24 3.959 2.754 5.144C22.26 56.322 24.115 57 25.5 57v-1ZM19 50V37h-1v13h1Zm0-13c0-.907.488-2.289 1.566-3.449C21.628 32.41 23.25 31.5 25.5 31.5v-1c-2.549 0-4.428 1.039-5.666 2.37C18.612 34.185 18 35.803 18 37h1Zm6.5-5.5H33v-1h-7.5v1Zm12 0H49v-1H37.5v1Zm11.5 0c1.127 0 3.022.556 4.632 1.796C55.224 34.522 56.5 36.386 56.5 39h1c0-2.986-1.474-5.122-3.257-6.496-1.765-1.36-3.87-2.004-5.243-2.004v1Zm7.5 7.5c0 3.792-1.879 5.651-3.277 6.584l.554.832C55.38 45.349 57.5 43.208 57.5 39h-1Zm-3.464 7.186c.995 2.488 2.505 6.514 4.517 10.538l.894-.448c-1.988-3.976-3.478-7.95-4.483-10.462l-.928.372ZM58 56h-8v1h8v-1Zm-7.542.3-3.5-8-.916.4 3.5 8 .916-.4ZM47 48.5V42h-1v6.5h1Zm-.5-6c.79 0 1.657-.129 2.34-.584.718-.479 1.16-1.27 1.16-2.416h-1c0 .854-.309 1.313-.715 1.584-.442.295-1.075.416-1.785.416v1Zm3.5-3c0-.499-.171-.906-.468-1.214-.284-.295-.655-.47-1.013-.577-.708-.213-1.533-.209-2.019-.209v1c.514 0 1.189.004 1.731.166.267.08.459.187.58.314.11.114.189.269.189.52h1Zm-3.5-2H45v1h1.5v-1Zm-2 .5v18.5h1V38h-1Zm.5 18h-7.5v1H45v-1Zm-7 .5V31h-1v25.5h1Zm27.023-25.35 2.5 8 .954-.3-2.5-8-.954.3Zm3.454 8 2.5-8-.954-.3-2.5 8 .954.3ZM70.5 31.5H79v-1h-8.5v1Zm8.04-.698-11 25.5.92.396 11-25.5-.92-.396Zm-10.08 25.5-11-25.5-.92.396 11 25.5.92-.396ZM57 31.5h8.5v-1H57v1Zm24 0h7.5v-1H81v1Zm7-.5v25.5h1V31h-1Zm.5 25H81v1h7.5v-1Zm-7 .5V31h-1v25.5h1Zm24-26.5c-4.104 0-7.61 1.284-10.094 3.637C92.92 35.993 91.5 39.381 91.5 43.5h1c0-3.88 1.33-6.993 3.594-9.137C98.36 32.216 101.604 31 105.5 31v-1Zm-14 13.5c0 4.885 1.806 8.403 4.488 10.693 2.67 2.279 6.166 3.307 9.512 3.307v-1c-3.154 0-6.407-.971-8.863-3.068-2.443-2.085-4.137-5.317-4.137-9.932h-1Zm14 14c3.384 0 6.874-1.428 9.517-3.75 2.646-2.323 4.483-5.576 4.483-9.25h-1c0 3.326-1.663 6.323-4.142 8.5-2.482 2.178-5.742 3.5-8.858 3.5v1ZM119 44h-8v1h8v-1Zm-8.498.45a5.625 5.625 0 0 1-1.201 2.858c-.766.934-1.961 1.692-3.801 1.692v1c2.16 0 3.632-.909 4.574-2.058a6.636 6.636 0 0 0 1.424-3.392l-.996-.1ZM105.5 49c-3.197 0-5.5-2.749-5.5-5.5h-1c0 3.249 2.697 6.5 6.5 6.5v-1Zm-5.5-5.5c0-3.197 2.749-5.5 5.5-5.5v-1c-3.249 0-6.5 2.697-6.5 6.5h1Zm5.5-5.5c1.599 0 2.857.683 3.721 1.49.433.405.761.834.978 1.212.227.396.301.679.301.798h1c0-.38-.176-.848-.434-1.296a6.315 6.315 0 0 0-1.162-1.444c-1.011-.943-2.503-1.76-4.404-1.76v1Zm5.5 4h8v-1h-8v1Zm8.5-.5c0-1.624-.796-4.49-2.935-6.953C114.406 32.062 110.893 30 105.5 30v1c5.107 0 8.344 1.938 10.31 4.203 1.986 2.287 2.69 4.921 2.69 6.297h1ZM136 31v7h1v-7h-1Zm.5 6.5H131v1h5.5v-1Zm-5.5 0a1.58 1.58 0 0 0-.66.17 2.683 2.683 0 0 0-.608.405c-.364.32-.732.82-.732 1.425h1c0-.195.132-.445.393-.675.123-.108.256-.194.377-.252a.647.647 0 0 1 .23-.073v-1Zm-2 2c0 .686.348 1.194.75 1.515.386.31.868.485 1.25.485v-1c-.118 0-.386-.074-.625-.265-.223-.179-.375-.42-.375-.735h-1Zm2 2h5v-1h-5v1Zm4.5-.5v5.5h1V41h-1Zm.5 5h-5.5v1h5.5v-1Zm-5.5 0c-.515 0-1.012.056-1.388.29-.433.267-.612.703-.612 1.21h1c0-.255.071-.32.138-.36.124-.077.377-.14.862-.14v-1Zm-2 1.5c0 .577.145 1.102.521 1.479.377.376.902.521 1.479.521v-1c-.423 0-.648-.105-.771-.229-.124-.123-.229-.348-.229-.771h-1Zm2 2h6v-1h-6v1Zm5.5-.5v7.5h1V49h-1Zm.5 7h-7v1h7v-1Zm-7 0c-3.312 0-7-2.457-7-6.5h-1c0 4.757 4.312 7.5 8 7.5v-1Zm-7-6.5v-13h-1v13h1Zm0-13c0-.943.681-2.191 1.901-3.232 1.202-1.024 2.84-1.768 4.599-1.768v-1c-2.037 0-3.899.857-5.248 2.008-1.331 1.135-2.252 2.636-2.252 3.992h1Zm6.5-5h7.5v-1H129v1Z"fill=#000 /></svg></div><div><div class=invoice__info><b>DUEÑO :</b> <span>Gerardo Lopez</span></div><div class=invoice__info><b>RUC :</b> <span>10092915447</span></div><div class=invoice__info><b>TELF / YAPE :</b> <span>994 012 698</span></div><div class=invoice__info><b>DIRECCIÓN :</b> <span>Av. Cesar Canevaro 806, Lince, Lima</span></div><div class=invoice__info><b>BCP :</b> <span>19392550347097</span></div><div class=invoice__info><b>CCI :</b> <span>00219319255034709710</span></div></div><div class=invoice__id><b>ORDEN DE TRABAJO</b> <span><b>N°:</b> <span><%= it.id %></span></span></div></div><div class=invoice__row2><div class=invoice__ctnr1><div class=invoice__info><b>NOMBRE :</b> <span><%= it.name %></span></div><div class=invoice__info><b>DIRECCIÓN :</b> <span><%= it.address %></span></div><div class=invoice__info><b>D.N.I :</b> <span><%= it.dni %></span></div><div class=invoice__info><b>R.U.C :</b> <span><%= it.ruc %></span></div><div class=invoice__info><b>FECHA EMISIÓN :</b> <span><%= it.date %></span></div></div><div class=invoice__ctnr1><div class=invoice__info><b>MARCA :</b> <span><%= it.brand %></span></div><div class=invoice__info><b>MODELO :</b> <span><%= it.model %></span></div><div class=invoice__info><b>COLOR :</b> <span><%= it.color %></span></div><div class=invoice__info><b>PLACA :</b> <span><%= it.plate %></span></div><div class=invoice__info><b>KILOMETRAJE :</b> <span><%= it.mileage %></span></div></div></div><div class=invoice__row3><table class=invoice__table><thead><tr><th>CÓDIGO<th>CANTIDAD<th style=width:50%>DESCRIPCIÓN<th>P. UNITARIO<th>P. TOTAL<tbody><% it.items.forEach(function(item){ %><tr><td><%= item.code %><td><%= item.quantity %><td><%= item.description %><td><%= item.punit %><td><%= item.ptotal %></tr><% }) %></table></div><div class=invoice__row4><div class=invoice__observation><b>OBSERVACIONES:</b> <span><%= it.observation %></span></div><div class=invoice__total><div class=invoice__ctnr2><div class=invoice__amount><b>SUBTOTAL :</b> <span>S/.<%= it.subtotal %></span></div><div class=invoice__amount><b>I.G.V :</b> <span>S/. 00.00</span></div></div><div class=invoice__ctnr3><b>TOTAL:</b> <span style=float:right>S/.<%= it.total %></span></div></div></div><style>*{margin:0;padding:0;font-family:sans-serif;font-size:14px}@page{size:auto;margin:0}@media print{body,html{height:100%;margin:0!important;padding:0!important;overflow:hidden}}.invoice{display:flex;flex-direction:column;height:27.2cm;width:19.2cm;padding:1rem;background:#fff;color:#000}.invoice__row1{display:grid;grid-template-columns:1fr 2fr 1fr;gap:1rem;margin-bottom:1rem}.invoice__logo{display:grid;place-content:center}.invoice__svg{width:100%}.invoice__id{display:flex;flex-direction:column;justify-content:center;gap:1rem;padding:.5rem;border:1px solid #000;text-align:center}.invoice__row2{display:grid;grid-template-columns:1fr 1fr;padding:.5rem;margin-bottom:1rem;border:1px solid #000}.invoice__ctnr1{display:flex;flex-direction:column;gap:.5rem}.invoice__row3{flex-grow:1;border:1px solid #000;margin-bottom:1rem}.invoice__table{width:100%;border-collapse:collapse}.invoice__table th{padding:.5rem;border:1px solid #000;border-top:none}.invoice__table td{padding:.2rem .5rem}.invoice__table th:first-child{border-left:none}.invoice__table th:last-child{border-right:none}.invoice__row4{display:grid;grid-template-columns:2fr 1fr;gap:1rem}.invoice__observation{padding:.5rem;border:1px solid #000}.invoice__total{display:flex;flex-direction:column;border:1px solid #000}.invoice__amount{display:flex;justify-content:space-between;margin-bottom:.5rem}.invoice__ctnr2{flex-grow:1;padding:.5rem}.invoice__ctnr3{padding:.5rem;border-top:1px solid #000}</style>
`
